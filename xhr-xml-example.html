<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>XHR with XML Example</title>
    <link rel="stylesheet" href="css/main.css" />
  </head>

  <body>
    <div class="container">
      <h1>XHR with XML Example</h1>
	  <nav>
	  <ul>
	  	<li><a href="index.html">Home</a></li>
		<li><a href="fetch-example-no-arrow.html">Quick Fetch Example</a></li>
	  	<li><a href="xhr-xml-example.html">XHR/XML</a></li>
	  	<li><a href="xhr-json-example.html">XHR/JSON</a></li>
	  	<li><a href="jquery-example.html">jQuery</a></li>
	  	<li><a href="fetch-example.html">Fetch</a></li>
	  	<li><a href="await-example.html">Fetch with async/await</a></li>
		<li><a href="fetch-post.html">Send data with Fetch</a></li>
	  </ul>
	  </nav>
      <p>
        The orignal XMLHttpRequest feature developed by Microsoft. In this
        example, it is used to retrieve some XML data. Once retrieved the data
        would need to be extracted from the XML. This is somewhat more
        complicated than working with the simple structure afforded by JSON
        data.
      </p>
      <ul class="busList"></ul>
    </div>
  </body>
  <script>
    (function () {
      var api = "data/buses.xml";
      var myXHR = new XMLHttpRequest();
      var busList = document.querySelector(".busList");
      var adList = "";
      myXHR.open("GET", api, true);
      myXHR.addEventListener("readystatechange", showData);
      myXHR.send();
      function showData() {
        if (myXHR.readyState == 4) {
          // console.dir(myXHR.responseXML);
          var buses = myXHR.responseXML.getElementsByTagName("bus");
          // console.dir(buses)
          for (var bus of buses) {
            // console.dir(bus)
            var start = bus.getElementsByTagName("start");
            console.dir(start);
            adList += "<li>Start: ";
            adList += start[0].innerHTML;
            adList += " Destination: ";
            adList += bus.getElementsByTagName("destination")[0].innerHTML;
            adList += "</li>";
            // console.dir(bus.getElementsByTagName("destination").innerHTML)
            // console.dir(bus.getElementsByTagName("destination"))
          }
          busList.innerHTML = adList;
        }
      }
    })();
  </script>
</html>
